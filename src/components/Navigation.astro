---
const navLinks = [
  { name: "Schedule", url: "/schedule" },
  { name: "Memberships", url: "/memberships" },
  { name: "About Us", url: "/aboutus" },
  { name: "Services", url: "/services" },
  { name: "Contact", url: "/contact" },
  { name: "Q&A", url: "/q&a" },
];
---

<nav class="nav-container sticky top-0 z-50 bg-black/80 backdrop-blur-xl border-b border-white/5 px-6 md:px-8 py-6 w-full">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
        <a href="/" class="transition-opacity hover:opacity-80 cursor-pointer z-60">
            <img 
                src="/MainLogo.png" 
                alt="Utopia Studio Logo" 
                class="h-8 md:h-12 w-auto object-contain"
            />
        </a>

        <button class="menu-toggle md:hidden text-white focus:outline-none z-60 p-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path class="menu-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16m-7 6h7" />
            </svg>
        </button>

        <ul class="nav-menu fixed top-0 right-0 h-screen w-full z-50 bg-black flex flex-col items-center justify-center gap-6 translate-x-full transition-transform duration-500 ease-in-out md:relative md:h-auto md:w-auto md:bg-transparent md:flex-row md:translate-x-0 md:z-auto lg:gap-10">
            {navLinks.map((link) => (
                <li class="relative group">
                    <a 
                        href={link.url} 
                        class="cursor-pointer text-sm md:text-[10px] lg:text-xs uppercase tracking-[0.3em] text-white md:text-gray-400 transition-all duration-300 font-light group-hover:text-gold flex flex-col items-center"
                    >
                        {link.name}
                        <span class="hidden md:block absolute -bottom-2 w-1 h-1 bg-gold rounded-full opacity-0 transition-all duration-300 group-hover:opacity-100 group-hover:translate-y-1"></span>
                    </a>
                </li>
            ))}
        </ul>
    </div>
</nav>

<script>
    // This function sets up the menu logic for EVERY nav bar it finds
    function setupNav() {
        const navContainers = document.querySelectorAll('.nav-container');

        navContainers.forEach(nav => {
            const toggle = nav.querySelector('.menu-toggle');
            const menu = nav.querySelector('.nav-menu');
            const path = nav.querySelector('.menu-path');
            const body = document.body;

            toggle?.addEventListener('click', () => {
                const isOpen = menu?.classList.contains('translate-x-0');
                
                if (isOpen) {
                    menu?.classList.remove('translate-x-0');
                    menu?.classList.add('translate-x-full');
                    path?.setAttribute('d', 'M4 6h16M4 12h16m-7 6h7');
                    body.style.overflow = ''; 
                } else {
                    menu?.classList.remove('translate-x-full');
                    menu?.classList.add('translate-x-0');
                    path?.setAttribute('d', 'M6 18L18 6M6 6l12 12');
                    body.style.overflow = 'hidden'; 
                }
            });

            // Close menu when a link is clicked
            const links = menu?.querySelectorAll('a');
            links?.forEach(link => {
                link.addEventListener('click', () => {
                    menu?.classList.remove('translate-x-0');
                    menu?.classList.add('translate-x-full');
                    path?.setAttribute('d', 'M4 6h16M4 12h16m-7 6h7');
                    body.style.overflow = '';
                });
            });
        });
    }

    // Run setup on initial load
    setupNav();

    // Re-run setup if the page content changes (important for Astro transitions)
    document.addEventListener('astro:after-swap', setupNav);
</script>